# Fastp Quality Control Report

This document provides a quality control summary generated by **fastp (v0.23.2)** for the dataset **ERR14218664**. The sequencing data are paired-end reads (101 cycles each).
## Command to run fastp
```bash
fastp -i sra_data/ERR14218891/ERR14218891_pass_1.fastq.gz \
      -I sra_data/ERR14218891/ERR14218891_pass_2.fastq.gz \
      -o fastp_output/ERR14218891_trimmed_R1.fastq.gz \
      -O fastp_output/ERR14218891_trimmed_R2.fastq.gz \
      --detect_adapter_for_pe -q 20 -u 20 -l 45 -w 8 \
      -j fastp_output/ERR14218891_fastp.json \
      -h fastp_output/ERR14218891_fastp.html
```
# Breakdown of `fastp` Command Options 

| Option | Description | Example |
|--------|-------------|---------|
| `-i <file>` | Input file for **read 1** (forward reads). | `sra_data/ERR14218891/ERR14218891_pass_1.fastq.gz` |
| `-I <file>` | Input file for **read 2** (reverse reads). | `sra_data/ERR14218891/ERR14218891_pass_2.fastq.gz` |
| `-o <file>` | Output file for **trimmed forward reads**. | `fastp_output/ERR14218891_trimmed_R1.fastq.gz` |
| `-O <file>` | Output file for **trimmed reverse reads**. | `fastp_output/ERR14218891_trimmed_R2.fastq.gz` |
| `--detect_adapter_for_pe` | Detects and trims adapter sequences in **paired-end mode**. | *(no value required)* |
| `-q <int>` | Trims bases from the **3′ end** if Phred quality score < *int*. | `-q 20` → trims bases < Q20 |
| `-u <int>` | Discards reads with more than *int%* of bases below quality threshold. | `-u 20` → removes reads with >20% low-quality bases |
| `-l <int>` | Discards reads shorter than *int* bp after trimming. | `-l 45` → removes reads < 45 bp |
| `-w <int>` | Number of **parallel threads** to use. | `-w 8` → uses 8 threads |
| `-j <file>` | Output **JSON report** with trimming & QC stats. | `fastp_output/ERR14218891_fastp.json` |
| `-h <file>` | Output **HTML report** with interactive plots & summaries. | `fastp_output/ERR14218891_fastp.html` |

---

## General Summary
- **fastp version:** 0.23.2  
- **Sequencing type:** Paired-end (101 cycles + 101 cycles)  
- **Mean read length (before filtering):** 100 bp, 100 bp  
- **Mean read length (after filtering):** 100 bp, 100 bp  
- **Duplication rate:** 0.29%  
- **Insert size peak:** 169 bp  

This indicates that the sequencing run generated consistent, high-quality paired-end reads with minimal duplication.

---

## Before Filtering
- **Total reads:** 2.16 M  
- **Total bases:** 217.6 Mbp  
- **Q20 bases:** 213.07 M (97.9%)  
- **Q30 bases:** 197.7 M (90.9%)  
- **GC content:** 49.7%  

High percentages of Q20 and Q30 bases indicate reliable sequencing quality.

---

## After Filtering
- **Total reads:** 2.08 M  
- **Total bases:** 209.1 Mbp  
- **Q20 bases:** 206.4 M (98.7%)  
- **Q30 bases:** 193.6 M (92.6%)  
- **GC content:** 49.6%  

After filtering, the overall sequence quality improved slightly (higher Q20/Q30 proportions), showing that trimming removed low-quality bases while retaining most reads.

---

## Filtering Results
- **Reads passed filters:** 2.08 M (96.1%)  
- **Reads with low quality:** 85.0 K (3.93%)  
- **Reads with too many Ns:** 0  
- **Reads too short:** 42  

Only a small fraction of reads were discarded, confirming that the dataset is clean and suitable for downstream analysis.

---

## Adapter Content
Adapters or bad ligation sequences were present in very low percentages (~0.007–0.008%). This suggests that adapter trimming was already applied during preprocessing.
<img width="1105" height="560" alt="image" src="https://github.com/user-attachments/assets/c2f269b6-0a3d-44ae-8138-324af6eae853" />


### Read 1 Adapters
- Common adapter fragments detected include `C`, `CT`, `CTG`, and `CTGT`.  

### Read 2 Adapters
- Similar low-level adapter sequences were detected.

---

## Insert Size Estimation
The insert size distribution shows a peak around **169 bp**. Approximately **91.2% of read pairs** did not overlap, which is expected for paired-end libraries with this insert size.

<img width="1175" height="577" alt="image" src="https://github.com/user-attachments/assets/0ffbab1f-d204-4208-9e00-c2c87e51b769" />


---

## Quality Profiles (after Filtering)
Per-base quality distribution and nucleotide composition plots help identify sequencing bias.

- **Read 1 Quality Profile:**  
  <img width="1277" height="833" alt="image" src="https://github.com/user-attachments/assets/2d2de70e-7585-4fa0-9a15-88c27598f6ec" />


- **Read 1 Base Content:**  
  <img width="1268" height="797" alt="image" src="https://github.com/user-attachments/assets/6e4c136d-515f-430c-8643-1d0d88009ff3" />


- **K-mer Analysis:**  
  <img width="938" height="832" alt="image" src="https://github.com/user-attachments/assets/280df7d2-a83e-4762-b9af-a53d03d3f90d" />


---

## Conclusion
The sequencing data show **excellent quality**, with very high Q30 scores, low duplication, minimal adapter contamination, and balanced GC content (~49.6%). After filtering, more than **96% of reads** were retained, making this dataset suitable for downstream analysis.

